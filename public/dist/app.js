var myYelp=angular.module("myYelp",[]);myYelp.controller("yelpController",["$http","$q",function(e,s){vm=this,vm.yelpBusinesses=[],vm.term=["american","chinese","markets","gas stations","liquor stores","bars","korean","mexican","gyms","antiques","cafe","electronics","clothes","beauty salons","hotels","donuts","bakery","mediterranean","italian","drug stores","chiropractors"],vm.d3Data=[{stars:"0.0-0.9",name:"unclaimed"},{stars:"0.0-0.9",name:"claimed"},{stars:"1.0-1.9",name:"unclaimed"},{stars:"1.0-1.9",name:"claimed"},{stars:"2.0-2.9",name:"unclaimed"},{stars:"2.0-2.9",name:"claimed"},{stars:"3.0-3.9",name:"unclaimed"},{stars:"3.0-3.9",name:"claimed"},{stars:"4.0-5.0",name:"unclaimed"},{stars:"4.0-5.0",name:"claimed"}];vm.dataOrganizer=function(e){for(var s=0;s<e.businesses.length;s++){var a={};e.businesses[s].review_count<20?console.log("skip"):e.businesses[s].id==a.id?console.log("skip"):(a.name=e.businesses[s].name,a.claimed=e.businesses[s].is_claimed,a.rating=e.businesses[s].rating,a.reviews=e.businesses[s].review_count,a.id=e.businesses[s].id,vm.yelpBusinesses.push(a))}return vm.yelpBusinesses},vm.d3dataOrganizer=function(e){for(var s=0;s<e.length;s++){var a=[],n=[],t=[],l=[],m=[],r=[],i=[],u=[],v=[],o=[],d=e[s].businessInfo.rating,c=e[s].businessInfo.claimed;1>d&&0==c?a.push(e[s]):1>d&&1==c?n.push(e[s]):2>d&&0==c?t.push(e[s]):2>d&&1==c?l.push(e[s]):3>d&&0==c?m.push(e[s]):3>d&&1==c?r.push(e[s]):4>d&&0==c?i.push(e[s]):4>d&&1==c?u.push(e[s]):5>d&&0==c?v.push(e[s]):5>d&&1==c&&o.push(e[s])}return vm.d3Data[0].value=a.length,vm.d3Data[1].value=n.length,vm.d3Data[2].value=t.length,vm.d3Data[3].value=l.length,vm.d3Data[4].value=m.length,vm.d3Data[5].value=r.length,vm.d3Data[6].value=i.length,vm.d3Data[7].value=u.length,vm.d3Data[8].value=v.length,vm.d3Data[9].value=o.length,vm.d3Data},vm.httpGetter=function(a){for(var n=[],t=0;t<a.length;t++)for(var l=0;2>l;l++)vm.reqNum=20*l,n.push(e.get("http://localhost:8080/businesses/"+vm.location+"/"+vm.term[t]+"/"+vm.reqNum));console.log(n),s.all(n).then(function(e){console.log(e);var s=dataOrganizer(e.data);return s})},vm.submit=function(){vm.httpGetter(vm.term)}}]);