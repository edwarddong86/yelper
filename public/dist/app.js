var myYelp=angular.module("myYelp",[]);myYelp.controller("yelpController",["$http","httpCache",function(e,s){vm=this,vm.httpCache=$cacheFactory("$http"),vm.yelpBusinesses=[],vm.term=["american","chinese","markets","gas stations","liquor stores","bars","korean","mexican","gyms","antiques","cafe","electronics","clothes","beauty salons","hotels","donuts","bakery","mediterranean","italian","drug stores","chiropractors"],vm.d3Data=[{stars:"0.0-0.9",name:"unclaimed"},{stars:"0.0-0.9",name:"claimed"},{stars:"1.0-1.9",name:"unclaimed"},{stars:"1.0-1.9",name:"claimed"},{stars:"2.0-2.9",name:"unclaimed"},{stars:"2.0-2.9",name:"claimed"},{stars:"3.0-3.9",name:"unclaimed"},{stars:"3.0-3.9",name:"claimed"},{stars:"4.0-5.0",name:"unclaimed"},{stars:"4.0-5.0",name:"claimed"}],vm.dataOrganizer=function(e){for(var s=0;s<e.businesses.length;s++){var a={};e.businesses[s].review_count<20?console.log("skip"):e.businesses[s].id==a.id?console.log("skip"):(a.name=e.businesses[s].name,a.claimed=e.businesses[s].is_claimed,a.rating=e.businesses[s].rating,a.reviews=e.businesses[s].review_count,a.id=e.businesses[s].id,vm.yelpBusinesses.push(a))}return vm.yelpBusinesses},vm.d3dataOrganizer=function(e){for(var s=0;s<e.length;s++){var a=[],t=[],n=[],m=[],l=[],r=[],i=[],u=[],o=[],c=[],v=e[s].businessInfo.rating,h=e[s].businessInfo.claimed;1>v&&0==h?a.push(e[s]):1>v&&1==h?t.push(e[s]):2>v&&0==h?n.push(e[s]):2>v&&1==h?m.push(e[s]):3>v&&0==h?l.push(e[s]):3>v&&1==h?r.push(e[s]):4>v&&0==h?i.push(e[s]):4>v&&1==h?u.push(e[s]):5>v&&0==h?o.push(e[s]):5>v&&1==h&&c.push(e[s])}return vm.d3Data[0].value=a.length,vm.d3Data[1].value=t.length,vm.d3Data[2].value=n.length,vm.d3Data[3].value=m.length,vm.d3Data[4].value=l.length,vm.d3Data[5].value=r.length,vm.d3Data[6].value=i.length,vm.d3Data[7].value=u.length,vm.d3Data[8].value=o.length,vm.d3Data[9].value=c.length,vm.d3Data},vm.httpGetter=function(s){for(var a=0;a<s.length;a++)for(var t=0;2>t;t++)vm.reqNum=20*t,e.get("http://localhost:8080/businesses/"+vm.location+"/"+vm.term[a]+"/"+vm.reqNum,{cache:!0}).success(function(e){console.log("success")}).error(function(e){console.log(e)})},vm.cachedResponse=s.get("http://localhost:8080/businesses/"+vm.location+"/"+vm.term[k]+"/"+vm.reqNum),vm.submit=function(){vm.organizedData=vm.dataOrganizer(vm.cachedResponse),console.log(vm.organizedData)}}]);