var myYelp=angular.module("myYelp",[]);myYelp.controller("yelpController",["$http","$q",function(a,e){vm=this,vm.yelpBusinesses=[],vm.term=["american","chinese","markets","gas stations","liquor stores","bars","korean","mexican","gyms","antiques","cafe","electronics","clothes","beauty salons","hotels","donuts","bakery","mediterranean","italian","drug stores","chiropractors"],vm.d3Data=[{stars:"0.0-0.9",name:"unclaimed"},{stars:"0.0-0.9",name:"claimed"},{stars:"1.0-1.9",name:"unclaimed"},{stars:"1.0-1.9",name:"claimed"},{stars:"2.0-2.9",name:"unclaimed"},{stars:"2.0-2.9",name:"claimed"},{stars:"3.0-3.9",name:"unclaimed"},{stars:"3.0-3.9",name:"claimed"},{stars:"4.0-5.0",name:"unclaimed"},{stars:"4.0-5.0",name:"claimed"}],vm.dataOrganizer=function(a){for(var e=0;e<a.length;e++)for(var s=0;s<a[e].data.businesses.length;s++){var t={};a[e].data.businesses[s].review_count<10?console.log("skip"):a[e].data.businesses[s].id==t.id?console.log("skip"):(t.name=a[e].data.businesses[s].name,t.claimed=a[e].data.businesses[s].is_claimed,t.rating=a[e].data.businesses[s].rating,t.reviews=a[e].data.businesses[s].review_count,t.id=a[e].data.businesses[s].id,vm.yelpBusinesses.push(t))}return vm.yelpBusinesses},vm.d3dataOrganizer=function(a){for(var e=[],s=[],t=[],n=[],l=[],r=[],m=[],i=[],u=[],v=[],o=0;o<a.length;o++){var d=a[o].rating,h=a[o].claimed;1>d&&0==h?e.push(a[o]):1>d&&1==h?s.push(a[o]):2>d&&0==h?t.push(a[o]):2>d&&1==h?n.push(a[o]):3>d&&0==h?l.push(a[o]):3>d&&1==h?r.push(a[o]):4>d&&0==h?m.push(a[o]):4>d&&1==h?i.push(a[o]):5>d&&0==h?u.push(a[o]):5>d&&1==h&&v.push(a[o])}return vm.d3Data[0].value=e.length,console.log(e.length),vm.d3Data[1].value=s.length,vm.d3Data[2].value=t.length,vm.d3Data[3].value=n.length,vm.d3Data[4].value=l.length,vm.d3Data[5].value=r.length,vm.d3Data[6].value=m.length,vm.d3Data[7].value=i.length,vm.d3Data[8].value=u.length,vm.d3Data[9].value=v.length,console.log(i.length),vm.d3Data},vm.submit=function(){vm.httpGetter=function(s){for(var t=[],n=0;n<s.length;n++)for(var l=0;2>l;l++)vm.reqNum=20*l,t.push(a.get("http://localhost:8080/businesses/"+vm.location+"/"+vm.term[n]+"/"+vm.reqNum));e.all(t).then(function(a){var e=vm.dataOrganizer(a);console.log(e);var s=vm.d3dataOrganizer(e);console.log(s),vm.barGraph=d3plus.viz().container("div#graph").data(s).type("bar").id("name").x("stars").y("value").draw()})},vm.httpGetter(vm.term)}}]);